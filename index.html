<html>
<head>
<base href="https://cookie-clicker-adventure.com/">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cookie Clicker Adventure</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
<style>
    body {
        background: linear-gradient(135deg, #1a1c2c 0%, #2b2e4a 100%);
        font-family: 'Press Start 2P', cursive;
        color: #fff;
        margin: 0;
        padding: 20px;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .game-container {
        max-width: 1200px;
        width: 100%;
        display: flex;
        gap: 40px;
        padding: 20px;
    }

    .game-left {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .game-right {
        flex: 1;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 15px;
        padding: 20px;
    }

    .orbit-container {
        position: relative;
        width: 300px;
        height: 300px;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    #cookie {
        width: 200px;
        height: 200px;
        cursor: pointer;
        transition: transform 0.1s;
        filter: drop-shadow(0 0 10px #ffd700);
        animation: float 3s ease-in-out infinite;
        transform-origin: center;
    }

    .orbiting-item {
        position: absolute;
        width: 20px;
        height: 20px;
        animation: orbit linear infinite;
        transform-origin: 150px;
    }

    .orbiting-item img {
        width: 100%;
        height: 100%;
        filter: drop-shadow(0 0 2px #ffd700);
    }

    @keyframes orbit {
        from { transform: rotate(0deg) translateX(120px) rotate(0deg); }
        to { transform: rotate(360deg) translateX(120px) rotate(-360deg); }
    }

    @keyframes float {
        0% { transform: translateY(0px); }
        50% { transform: translateY(-20px); }
        100% { transform: translateY(0px); }
    }

    /* Add new click animation */
    @keyframes clickPulse {
        0% { transform: scale(0.95); filter: brightness(1.5) drop-shadow(0 0 15px #ffd700); }
        50% { transform: scale(0.97); filter: brightness(1.2) drop-shadow(0 0 12px #ffd700); }
        100% { transform: scale(1); filter: brightness(1) drop-shadow(0 0 10px #ffd700); }
    }

    #cookie:active {
        transform: scale(0.95);
    }

    .click-effect {
        position: absolute;
        pointer-events: none;
        animation: clickEffect 0.5s ease-out forwards;
    }

    @keyframes clickEffect {
        0% { transform: scale(1.2); opacity: 1; }
        100% { transform: scale(0.8); opacity: 0; }
    }

    .stats {
        background: rgba(0, 0, 0, 0.5);
        padding: 20px;
        border-radius: 10px;
        margin: 20px 0;
        border: 2px solid #ffd700;
        text-align: center;
        width: 100%;
        box-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
    }

    #score {
        font-size: 1.5em;
        color: #ffd700;
        margin: 10px 0;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
    }

    #cps {
        font-size: 0.8em;
        color: #a0a0a0;
    }

    .shop-title {
        text-align: center;
        color: #ffd700;
        margin-bottom: 20px;
    }

    .shop-items {
        display: grid;
        gap: 15px;
    }

    .item {
        background: rgba(0, 0, 0, 0.5);
        border: 2px solid #4a4a4a;
        border-radius: 8px;
        padding: 15px;
        cursor: pointer;
        transition: all 0.3s;
        display: flex;
        align-items: center;
        gap: 15px;
    }

    .item:hover {
        border-color: #ffd700;
        transform: translateX(5px);
    }

    .item img {
        width: 40px;
        height: 40px;
        border-radius: 5px;
    }

    .item-info {
        flex-grow: 1;
    }

    .item-name {
        font-size: 0.8em;
        color: #ffd700;
        margin-bottom: 5px;
    }

    .item-cost {
        font-size: 0.6em;
        color: #a0a0a0;
    }

    .item-owned {
        font-size: 0.7em;
        color: #4CAF50;
    }

    .particles {
        position: fixed;
        pointer-events: none;
    }

    @keyframes shine {
        0% { filter: brightness(1); }
        50% { filter: brightness(1.5); }
        100% { filter: brightness(1); }
    }

    .notification {
        position: fixed;
        top: 20px;
        right: 20px;
        background: rgba(255, 215, 0, 0.2);
        padding: 10px 20px;
        border-radius: 5px;
        border: 1px solid #ffd700;
        animation: fadeOut 2s forwards;
        pointer-events: none;
    }

    @keyframes fadeOut {
        to {
            opacity: 0;
            transform: translateY(-20px);
        }
    }

    .chat-container {
        background: rgba(0, 0, 0, 0.5);
        border: 2px solid #ffd700;
        border-radius: 10px;
        width: 100%;
        margin-top: 20px;
        overflow: hidden;
    }

    .chat-header {
        background: rgba(0, 0, 0, 0.7);
        padding: 10px;
        border-bottom: 2px solid #ffd700;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .chat-title {
        color: #ffd700;
        font-size: 0.8em;
    }

    .minimize-btn {
        background: none;
        border: none;
        color: #ffd700;
        cursor: pointer;
        font-size: 1.2em;
    }

    .chat-messages {
        height: 200px;
        overflow-y: auto;
        padding: 10px;
    }

    .chat-input {
        display: flex;
        gap: 10px;
        padding: 10px;
        border-top: 2px solid #ffd700;
    }

    .chat-input input {
        flex: 1;
        background: rgba(0, 0, 0, 0.5);
        border: 1px solid #ffd700;
        border-radius: 5px;
        padding: 5px 10px;
        color: white;
        font-family: 'Press Start 2P', cursive;
        font-size: 0.7em;
    }

    #send-btn {
        background: #ffd700;
        border: none;
        border-radius: 5px;
        width: 30px;
        height: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
    }

    #send-btn svg {
        width: 20px;
        height: 20px;
        fill: #000;
    }

    .message {
        margin: 5px 0;
        padding: 5px;
        border-radius: 5px;
        font-size: 0.7em;
        word-break: break-word;
    }

    .message.user {
        background: rgba(255, 215, 0, 0.2);
        margin-left: auto;
        border-radius: 5px 5px 0 5px;
    }

    .message.receiver {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 5px 5px 5px 0;
    }

    .message-header {
        color: #ffd700;
        font-size: 0.8em;
        margin-bottom: 3px;
    }

    #participant-list {
        padding: 5px 10px;
        font-size: 0.6em;
        color: #a0a0a0;
        background: rgba(0, 0, 0, 0.7);
        border-top: 2px solid #ffd700;
    }

    .chat-minimized {
        height: 40px;
        overflow: hidden;
    }

    .language-selector {
        display: flex;
        gap: 10px;
        justify-content: center;
        margin: 20px 0;
    }

    .flag {
        cursor: pointer;
        transition: all 0.3s ease;
        filter: saturate(0.7);
        padding: 5px;
        border-radius: 5px;
        background: rgba(255, 255, 255, 0.1);
    }

    .flag:hover {
        transform: scale(1.1);
        filter: saturate(1.2);
        background: rgba(255, 215, 0, 0.2);
    }

    .flag.active {
        background: rgba(255, 215, 0, 0.3);
        filter: saturate(1.2);
        box-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
    }

    /* Add this to the existing CSS */
    .cookie-stage-1 {
        filter: grayscale(0.8) brightness(0.8) drop-shadow(0 0 10px #ffd700);
    }

    .cookie-stage-2 {
        filter: grayscale(0.5) brightness(0.9) drop-shadow(0 0 12px #ffd700);
    }

    .cookie-stage-3 {
        filter: grayscale(0.2) brightness(1) drop-shadow(0 0 15px #ffd700);
    }

    .cookie-stage-4 {
        filter: grayscale(0) brightness(1.1) saturate(1.2) drop-shadow(0 0 20px #ffd700);
    }

    .cookie-stage-5 {
        filter: grayscale(0) brightness(1.2) saturate(1.5) drop-shadow(0 0 25px #ffd700);
        animation: rainbow-glow 5s infinite;
    }

    @keyframes rainbow-glow {
        0% { filter: grayscale(0) brightness(1.2) saturate(1.5) drop-shadow(0 0 25px #ffd700); }
        25% { filter: grayscale(0) brightness(1.2) saturate(1.5) drop-shadow(0 0 25px #ff7000); }
        50% { filter: grayscale(0) brightness(1.2) saturate(1.5) drop-shadow(0 0 25px #ff0000); }
        75% { filter: grayscale(0) brightness(1.2) saturate(1.5) drop-shadow(0 0 25px #ff7000); }
        100% { filter: grayscale(0) brightness(1.2) saturate(1.5) drop-shadow(0 0 25px #ffd700); }
    }
</style>
</head>
<body>
    <h1 style="color: #ffd700; text-shadow: 2px 2px 4px rgba(0,0,0,0.5);">Aventure Cookie Clicker</h1>
    
    <div class="language-selector">
        <div class="flag" onclick="changeLanguage('pt-BR')">
            <img src="https://api.iconify.design/emojione:flag-for-brazil.svg" alt="PortuguÃªs" width="32" height="32">
        </div>
        <div class="flag" onclick="changeLanguage('en')">
            <img src="https://api.iconify.design/emojione:flag-for-united-states.svg" alt="English" width="32" height="32">
        </div>
        <div class="flag" onclick="changeLanguage('es')">
            <img src="https://api.iconify.design/emojione:flag-for-spain.svg" alt="EspaÃ±ol" width="32" height="32">
        </div>
        <div class="flag" onclick="changeLanguage('fr')">
            <img src="https://api.iconify.design/emojione:flag-for-france.svg" alt="FranÃ§ais" width="32" height="32">  
        </div>
        <div class="flag" onclick="changeLanguage('ru')">
            <img src="https://api.iconify.design/emojione:flag-for-russia.svg" alt="Ð ÑÑÑÐºÐ¸Ð¹" width="32" height="32">
        </div>
    </div>

    <div class="game-container">
        <div class="game-left">
            <div class="orbit-container">
                <img id="cookie" class="cookie-stage-1" src="https://api.iconify.design/noto:cookie.svg" alt="Cookie" onclick="clickCookie()">
                <div id="orbiting-items"></div>
            </div>
            <div class="stats">
                <div id="score">Cookies: 0</div>
                <div id="cps">Par seconde: 0</div>
            </div>
            <div id="chat-box" class="chat-container">
                <div class="chat-header">
                    <span class="chat-title">Chat Multijoueur</span>
                    <button class="minimize-btn" id="minimize-chat">â</button>
                </div>
                <div id="messages" class="chat-messages"></div>
                <div class="chat-input">
                    <input type="text" id="message-input" placeholder="Tapez un message...">
                    <button id="send-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
                        </svg>
                    </button>
                </div>
                <div id="participant-list"></div>
            </div>
        </div>
        
        <div class="game-right">
            <h2 class="shop-title">ðª Boutique de Cookies</h2>
            <div class="shop-items">
                <div class="item" onclick="purchaseItem(0)">
                    <img src="https://api.iconify.design/emojione:computer-mouse.svg" alt="Cursor">
                    <div class="item-info">
                        <div class="item-name">Curseur Automatique</div>
                        <div class="item-cost">CoÃ»t: <span id="cursor-cost">15</span> cookies</div>
                        <div class="item-owned" id="cursor-count">PossÃ©dÃ©s: 0</div>
                    </div>
                </div>

                <div class="item" onclick="purchaseItem(1)">
                    <img src="https://api.iconify.design/noto:factory.svg" alt="Factory">
                    <div class="item-info">
                        <div class="item-name">Mini Usine</div>
                        <div class="item-cost">CoÃ»t: <span id="factory-cost">100</span> cookies</div>
                        <div class="item-owned" id="factory-count">PossÃ©dÃ©s: 0</div>
                    </div>
                </div>

                <div class="item" onclick="purchaseItem(2)">
                    <img src="https://api.iconify.design/noto:magic-wand.svg" alt="Magic Wand">
                    <div class="item-info">
                        <div class="item-name">Baguette Magique</div>
                        <div class="item-cost">CoÃ»t: <span id="wand-cost">500</span> cookies</div>
                        <div class="item-owned" id="wand-count">PossÃ©dÃ©s: 0</div>
                    </div>
                </div>

                <div class="item" onclick="purchaseItem(3)">
                    <img src="https://api.iconify.design/emojione:older-woman.svg" alt="Grandma">
                    <div class="item-info">
                        <div class="item-name">Grand-mÃ¨re Ã  Cookies</div>
                        <div class="item-cost">CoÃ»t: <span id="grandma-cost">1000</span> cookies</div>
                        <div class="item-owned" id="grandma-count">PossÃ©dÃ©s: 0</div>
                    </div>
                </div>

                <div class="item" onclick="purchaseItem(4)">
                    <img src="https://api.iconify.design/emojione:bread.svg" alt="Bakery">
                    <div class="item-info">
                        <div class="item-name">Boulangerie</div>
                        <div class="item-cost">CoÃ»t: <span id="bakery-cost">5000</span> cookies</div>
                        <div class="item-owned" id="bakery-count">PossÃ©dÃ©s: 0</div>
                    </div>
                </div>

                <div class="item" onclick="purchaseItem(5)">
                    <img src="https://api.iconify.design/noto:doughnut.svg" alt="Robot">
                    <div class="item-info">
                        <div class="item-name">Robot Ã  Cookies</div>
                        <div class="item-cost">CoÃ»t: <span id="robot-cost">20000</span> cookies</div>
                        <div class="item-owned" id="robot-count">PossÃ©dÃ©s: 0</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let cookies = 0;
        let cps = 0;
        const items = [
            { name: 'cursor', cost: 15, cps: 0.1, owned: 0 },
            { name: 'factory', cost: 100, cps: 1, owned: 0 },
            { name: 'wand', cost: 500, cps: 5, owned: 0 },
            { name: 'grandma', cost: 1000, cps: 10, owned: 0 },
            { name: 'bakery', cost: 5000, cps: 50, owned: 0 },
            { name: 'robot', cost: 20000, cps: 200, owned: 0 }
        ];

        const cookieStages = [
            { threshold: 0, class: 'cookie-stage-1' },
            { threshold: 1000, class: 'cookie-stage-2' },
            { threshold: 10000, class: 'cookie-stage-3' },
            { threshold: 100000, class: 'cookie-stage-4' },
            { threshold: 1000000, class: 'cookie-stage-5' }
        ];

        const translations = {
            'pt-BR': {
                title: 'Cookie Clicker Adventure',
                cookies: 'Cookies',
                perSecond: 'Por segundo',
                shop: 'ðª Loja de Cookies',
                items: {
                    cursor: {
                        name: 'Cursor AutomÃ¡tico',
                        owned: 'PossuÃ­dos'
                    },
                    factory: {
                        name: 'Mini FÃ¡brica',
                        owned: 'PossuÃ­dos'
                    },
                    wand: {
                        name: 'Varinha MÃ¡gica',
                        owned: 'PossuÃ­dos'
                    },
                    grandma: {
                        name: 'VovÃ³ Faz Cookies',
                        owned: 'PossuÃ­dos'
                    },
                    bakery: {
                        name: 'Panificadora',
                        owned: 'PossuÃ­dos'
                    },
                    robot: {
                        name: 'RobÃ´ Fazedor de Cookies',
                        owned: 'PossuÃ­dos'
                    }
                },
                cost: 'Custo',
                insufficientCookies: 'Cookies insuficientes!',
                purchased: 'Comprou {item} por {cost} cookies!'
            },
            'en': {
                title: 'Cookie Clicker Adventure',
                cookies: 'Cookies',
                perSecond: 'Per second',
                shop: 'ðª Cookie Shop',
                items: {
                    cursor: {
                        name: 'Auto Cursor',
                        owned: 'Owned'
                    },
                    factory: {
                        name: 'Mini Factory',
                        owned: 'Owned'
                    },
                    wand: {
                        name: 'Magic Wand',
                        owned: 'Owned'
                    },
                    grandma: {
                        name: 'Cookie Grandma',
                        owned: 'Owned'
                    },
                    bakery: {
                        name: 'Bakery',
                        owned: 'Owned'
                    },
                    robot: {
                        name: 'Cookie Robot',
                        owned: 'Owned'
                    }
                },
                cost: 'Cost',
                insufficientCookies: 'Not enough cookies!',
                purchased: 'Purchased {item} for {cost} cookies!'
            },
            'es': {
                title: 'Aventura Cookie Clicker',
                cookies: 'Galletas',
                perSecond: 'Por segundo',
                shop: 'ðª Tienda de Galletas',
                items: {
                    cursor: {
                        name: 'Cursor AutomÃ¡tico',
                        owned: 'Obtenido'
                    },
                    factory: {
                        name: 'Mini FÃ¡brica',
                        owned: 'Obtenido'
                    },
                    wand: {
                        name: 'Varita MÃ¡gica',
                        owned: 'Obtenido'
                    },
                    grandma: {
                        name: 'Abuela de Galletas',
                        owned: 'Obtenido'
                    },
                    bakery: {
                        name: 'PanaderÃ­a',
                        owned: 'Obtenido'
                    },
                    robot: {
                        name: 'Robot de Galletas',
                        owned: 'Obtenido'
                    }
                },
                cost: 'Costo',
                insufficientCookies: 'Â¡Galletas insuficientes!',
                purchased: 'Â¡Compraste {item} por {cost} galletas!'
            },
            'fr': {
                title: 'Aventure Cookie Clicker',
                cookies: 'Cookies',
                perSecond: 'Par seconde',
                shop: 'ðª Boutique de Cookies',
                items: {
                    cursor: {
                        name: 'Curseur Automatique',
                        owned: 'PossÃ©dÃ©s'
                    },
                    factory: {
                        name: 'Mini Usine',
                        owned: 'PossÃ©dÃ©s'
                    },
                    wand: {
                        name: 'Baguette Magique',
                        owned: 'PossÃ©dÃ©s'
                    },
                    grandma: {
                        name: 'Grand-mÃ¨re Ã  Cookies',
                        owned: 'PossÃ©dÃ©s'
                    },
                    bakery: {
                        name: 'Boulangerie',
                        owned: 'PossÃ©dÃ©s'
                    },
                    robot: {
                        name: 'Robot Ã  Cookies',
                        owned: 'PossÃ©dÃ©s'
                    }
                },
                cost: 'CoÃ»t',
                insufficientCookies: 'Pas assez de cookies !',
                purchased: '{item} achetÃ© pour {cost} cookies !'
            },
            'ru': {
                title: 'ÐÑÐ¸ÐºÐ»ÑÑÐµÐ½Ð¸Ðµ Cookie Clicker',
                cookies: 'ÐÐµÑÐµÐ½ÑÐµ',
                perSecond: 'Ð ÑÐµÐºÑÐ½Ð´Ñ',
                shop: 'ðª ÐÐ°Ð³Ð°Ð·Ð¸Ð½ Ð¿ÐµÑÐµÐ½ÑÑ',
                items: {
                    cursor: {
                        name: 'ÐÐ²ÑÐ¾-ÐºÑÑÑÐ¾Ñ',
                        owned: 'ÐÑÐ¿Ð»ÐµÐ½Ð¾'
                    },
                    factory: {
                        name: 'ÐÐ¸Ð½Ð¸-ÑÐ°Ð±ÑÐ¸ÐºÐ°',
                        owned: 'ÐÑÐ¿Ð»ÐµÐ½Ð¾'
                    },
                    wand: {
                        name: 'ÐÐ¾Ð»ÑÐµÐ±Ð½Ð°Ñ Ð¿Ð°Ð»Ð¾ÑÐºÐ°',
                        owned: 'ÐÑÐ¿Ð»ÐµÐ½Ð¾'
                    },
                    grandma: {
                        name: 'ÐÐ°Ð±ÑÑÐºÐ°-Ð¿ÐµÐºÐ°ÑÑ',
                        owned: 'ÐÑÐ¿Ð»ÐµÐ½Ð¾'
                    },
                    bakery: {
                        name: 'ÐÐµÐºÐ°ÑÐ½Ñ',
                        owned: 'ÐÑÐ¿Ð»ÐµÐ½Ð¾'
                    },
                    robot: {
                        name: 'Ð Ð¾Ð±Ð¾Ñ-Ð¿ÐµÐºÐ°ÑÑ',
                        owned: 'ÐÑÐ¿Ð»ÐµÐ½Ð¾'
                    }
                },
                cost: 'Ð¦ÐµÐ½Ð°',
                insufficientCookies: 'ÐÐµÐ´Ð¾ÑÑÐ°ÑÐ¾ÑÐ½Ð¾ Ð¿ÐµÑÐµÐ½ÑÑ!',
                purchased: 'ÐÑÐ¿Ð»ÐµÐ½Ð¾ {item} Ð·Ð° {cost} Ð¿ÐµÑÐµÐ½ÑÑ!'
            }
        };

        let currentLanguage = 'fr'; 

        function changeLanguage(lang) {
            currentLanguage = lang;
            document.querySelectorAll('.flag').forEach(flag => flag.classList.remove('active'));
            document.querySelector(`.flag[onclick*="${lang}"]`).classList.add('active');
            document.title = translations[lang].title;
            document.querySelector('h1').textContent = translations[lang].title;
            document.querySelector('#score').textContent = `${translations[lang].cookies}: ${formatNumber(cookies)}`;
            document.querySelector('#cps').textContent = `${translations[lang].perSecond}: ${cps.toFixed(1)}`;
            document.querySelector('.shop-title').textContent = translations[lang].shop;

            updateDisplay();
        }

        function formatNumber(num) {
            if (num >= 1000000) {
                return (num/1000000).toFixed(1) + 'M';
            } else if (num >= 1000) {
                return (num/1000).toFixed(1) + 'K';
            }
            return Math.floor(num);
        }

        function updateDisplay() {
            document.getElementById('score').textContent = `${translations[currentLanguage].cookies}: ${formatNumber(cookies)}`;
            document.getElementById('cps').textContent = `${translations[currentLanguage].perSecond}: ${cps.toFixed(1)}`;
            
            const itemNames = ['cursor', 'factory', 'wand', 'grandma', 'bakery', 'robot'];
            itemNames.forEach((item, index) => {
                document.getElementById(`${item}-count`).textContent = 
                    `${translations[currentLanguage].items[item].owned}: ${items[index].owned}`;
                document.querySelector(`.item:nth-child(${index + 1}) .item-name`).textContent = 
                    translations[currentLanguage].items[item].name;
                document.querySelector(`.item:nth-child(${index + 1}) .item-cost`).textContent = 
                    `${translations[currentLanguage].cost}: ${items[index].cost}`;
            });
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            document.body.appendChild(notification);
            
            // Remove notification after animation completes
            notification.addEventListener('animationend', () => {
                notification.remove();
            });
        }

        function updateCookieAppearance() {
            const cookie = document.getElementById('cookie');
            const currentStage = cookieStages
                .slice()
                .reverse()
                .find(stage => cookies >= stage.threshold);
                
            // Remove all stage classes
            cookieStages.forEach(stage => {
                cookie.classList.remove(stage.class);
            });
            
            // Add current stage class
            if (currentStage) {
                cookie.classList.add(currentStage.class);
            }
        }

        function createParticle(x, y) {
            for (let i = 0; i < 3; i++) { // Create multiple particles
                const particle = document.createElement('div');
                particle.className = 'particles';
                // Random position offset
                const offsetX = (Math.random() - 0.5) * 40;
                const offsetY = (Math.random() - 0.5) * 40;
                particle.style.left = (x + offsetX) + 'px';
                particle.style.top = (y + offsetY) + 'px';
                particle.style.fontSize = '20px';
                particle.textContent = '+1';
                particle.style.color = '#ffd700';
                document.body.appendChild(particle);

                const animation = particle.animate([
                    { transform: 'translateY(0) rotate(0deg)', opacity: 1 },
                    { transform: `translateY(-${50 + Math.random() * 50}px) rotate(${(Math.random() - 0.5) * 90}deg)`, opacity: 0 }
                ], {
                    duration: 1000 + Math.random() * 500,
                    iterations: 1,
                    easing: 'ease-out'
                });

                animation.onfinish = () => particle.remove();
            }
        }

        const orbitingItems = {
            cursor: { duration: 5, delay: 0, clickInterval: 2000 },
            factory: { duration: 7, delay: 0.5, clickInterval: 1000 },
            wand: { duration: 6, delay: 1, clickInterval: 800 },
            grandma: { duration: 8, delay: 1.5, clickInterval: 1200 },
            bakery: { duration: 9, delay: 2, clickInterval: 600 },
            robot: { duration: 4, delay: 2.5, clickInterval: 400 }
        };

        function addOrbitingItem(type) {
            const container = document.getElementById('orbiting-items');
            const item = document.createElement('div');
            item.className = 'orbiting-item';
            item.innerHTML = `<img src="https://api.iconify.design/${getItemIcon(type)}.svg" alt="${type}">`;
            item.style.animation = `orbit ${orbitingItems[type].duration}s linear infinite`;
            item.style.animationDelay = `${orbitingItems[type].delay}s`;
            container.appendChild(item);
            
            // Start automatic clicking animation
            setInterval(() => {
                if(cookies >= 0) { // Only if game is active
                    createAutoClickEffect(item);
                }
            }, orbitingItems[type].clickInterval);
        }

        function getItemIcon(type) {
            const icons = {
                cursor: 'emojione:computer-mouse',
                factory: 'noto:factory',
                wand: 'noto:magic-wand',
                grandma: 'emojione:older-woman',
                bakery: 'emojione:bread',
                robot: 'noto:doughnut'
            };
            return icons[type];
        }

        function createAutoClickEffect(orbitingItem) {
            const effect = document.createElement('div');
            effect.className = 'click-effect';
            effect.innerHTML = `<img src="https://api.iconify.design/emojione:computer-mouse.svg" width="15" height="15">`;
            
            const rect = orbitingItem.getBoundingClientRect();
            effect.style.left = rect.left + 'px';
            effect.style.top = rect.top + 'px';
            
            document.body.appendChild(effect);
            
            // Add cookie value
            cookies++;
            updateDisplay();
            updateCookieAppearance();
            
            // Remove effect after animation
            effect.addEventListener('animationend', () => effect.remove());
        }

        function clickCookie() {
            cookies++;
            const cookie = document.getElementById('cookie');
            const rect = cookie.getBoundingClientRect();
            
            // Add click animation
            cookie.style.animation = 'none';
            cookie.offsetHeight; // Trigger reflow
            cookie.style.animation = 'float 3s ease-in-out infinite';
            cookie.animate([
                { transform: 'scale(0.95)', filter: 'brightness(1.5) drop-shadow(0 0 15px #ffd700)' },
                { transform: 'scale(0.97)', filter: 'brightness(1.2) drop-shadow(0 0 12px #ffd700)' },
                { transform: 'scale(1)', filter: 'brightness(1) drop-shadow(0 0 10px #ffd700)' }
            ], {
                duration: 300,
                easing: 'ease-out'
            });
            
            createParticle(rect.left + rect.width/2, rect.top);
            updateDisplay();
            updateCookieAppearance();
        }

        function purchaseItem(index) {
            const item = items[index];
            if (cookies >= item.cost) {
                cookies -= item.cost;
                item.owned++;
                if(item.owned === 1) { // Only add orbiting item on first purchase
                    addOrbitingItem(item.name);
                }
                item.cost = Math.ceil(item.cost * 1.15);
                cps += item.cps;
                updateDisplay();
                showNotification(translations[currentLanguage].purchased.replace('{item}', translations[currentLanguage].items[item.name].name).replace('{cost}', item.cost));
            } else {
                showNotification(translations[currentLanguage].insufficientCookies);
            }
        }

        setInterval(() => {
            cookies += cps;
            updateDisplay();
            updateCookieAppearance();
        }, 1000);

        const room = new WebsimSocket();
        const messagesContainer = document.getElementById('messages');
        const messageInput = document.getElementById('message-input');
        const sendButton = document.getElementById('send-btn');
        const minimizeBtn = document.getElementById('minimize-chat');
        const chatBox = document.getElementById('chat-box');
        let currentUser = null;

        async function getCurrentUser() {
            currentUser = await window.websim.getUser();
            return currentUser;
        }

        function updateParticipantList() {
            const participants = Object.values(room.party.peers).map(peer => peer.username);
            const participantList = document.getElementById('participant-list');
            participantList.innerHTML = participants.map(username => `
                <span style="color: #ffd700;">â ${username}</span>
            `).join(', ');
        }

        function addChatMessage(username, message, cookieCount) {
            const time = new Date().toLocaleTimeString([], { 
                hour: '2-digit', 
                minute: '2-digit' 
            });
            const messageElement = document.createElement('div');
            const isCurrentUser = username === currentUser.username;
            
            messageElement.className = `message ${isCurrentUser ? 'user' : 'receiver'}`;
            messageElement.innerHTML = `
                <div class="message-header">
                    ${username} â¢ ${time} â¢ ðª ${formatNumber(cookieCount)}
                </div>
                <div class="message-text">
                    ${message}
                </div>
            `;
            
            messagesContainer.appendChild(messageElement);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        room.onmessage = (event) => {
            const data = event.data;
            if (data.type === 'chatMessage') {
                addChatMessage(data.username, data.message, data.cookieCount);
            }
        };

        let isMinimized = false;
        minimizeBtn.addEventListener('click', () => {
            isMinimized = !isMinimized;
            chatBox.classList.toggle('chat-minimized');
            minimizeBtn.textContent = isMinimized ? '+' : 'â';
        });

        sendButton.addEventListener('click', () => {
            const message = messageInput.value.trim();
            if (message) {
                room.send({ 
                    type: 'chatMessage', 
                    username: currentUser.username, 
                    message: message,
                    cookieCount: cookies 
                });
                messageInput.value = '';
            }
        });

        messageInput.addEventListener('keypress', (event) => {
            if (event.key === 'Enter') {
                const message = messageInput.value.trim();
                if (message) {
                    room.send({ 
                        type: 'chatMessage', 
                        username: currentUser.username, 
                        message: message,
                        cookieCount: cookies 
                    });
                    messageInput.value = '';
                }
            }
        });

        room.onPeersChanged = updateParticipantList;

        getCurrentUser().then(() => {
            updateParticipantList();
        });

        updateDisplay();
    </script>
</body>
</html>
