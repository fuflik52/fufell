<!DOCTYPE html>
<html lang="ru">
<head>
    <!-- –ú–µ—Ç–∞-—Ç–µ–≥–∏ –∏ —Å—Ç–∏–ª–∏ -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ –ö–æ—Ä–≥–∏ –ö–ª–∏–∫–µ—Ä</title>
    <style>
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ç–µ–ª–∞ –∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
        body {
            font-family: 'Press Start 2P', cursive;
            background: linear-gradient(to bottom, #1a1c2c, #2b2e4a);
            color: white;
            margin: 0;
            padding: 0;
            min-height: 100vh;
            overflow-x: hidden;
            user-select: none;
        }
        .container {
            max-width: 100%;
            padding: 1rem;
            box-sizing: border-box;
        }
        h1 {
            font-size: 1.5rem;
            text-align: center;
            color: #ffd700;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        .game-container {
            max-width: 320px;
            margin: 0 auto;
        }
        /* –°—Ç–∏–ª–∏ –¥–ª—è –æ–±–ª–∞—Å—Ç–∏ –∫–ª–∏–∫–∞ */
        .orbit-container {
            position: relative;
            width: 200px;
            height: 200px;
            margin: 0 auto 1rem;
        }
        #clickArea {
            width: 100%;
            height: 100%;
            background-image: url('https://api.iconify.design/noto:dog-face.svg');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            cursor: pointer;
            position: relative;
            z-index: 1;
        }
        .stats {
            background-color: rgba(0, 0, 0, 0.5);
            border: 2px solid #ffd700;
            border-radius: 0.5rem;
            padding: 0.5rem;
            text-align: center;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
        }
        #score {
            font-size: 1.2rem;
            color: #ffd700;
            margin-bottom: 0.25rem;
        }
        #cps {
            font-size: 0.8rem;
            color: #a0a0a0;
        }
        .button-container {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        .game-button {
            font-family: 'Press Start 2P', cursive;
            font-size: 0.7rem;
            padding: 0.5rem;
            background-color: #4a4a5a;
            border: none;
            border-radius: 0.25rem;
            color: white;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .game-button:hover {
            background-color: #5a5a6a;
        }
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgb(37,40,64);
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }
        .modal-content {
            padding: 1rem;
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        .modal-title {
            font-size: 1.2rem;
            color: #ffd700;
        }
        .close-button {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }
        .shop-item, .reward-item, .task-item {
            background-color: rgba(0, 0, 0, 0.5);
            border: 2px solid #4a4a5a;
            border-radius: 0.5rem;
            padding: 0.5rem;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .shop-item {
            justify-content: space-between;
        }
        .shop-item img {
            width: 2rem;
            height: 2rem;
        }
        .item-info {
            flex-grow: 1;
            text-align: left;
        }
        .item-name {
            font-size: 0.8rem;
            color: #ffd700;
        }
        .item-cost, .item-owned {
            font-size: 0.7rem;
            color: #a0a0a0;
        }
        .help-icon {
            color: #4CAF50;
            cursor: help;
            font-size: 1rem;
            margin-left: 0.5rem;
        }
        .tooltip {
            position: fixed;
            background-color: rgba(0, 0, 0, 0.8);
            color: #ffd700;
            padding: 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.7rem;
            z-index: 1001;
            display: none;
            text-align: center;
            max-width: 200px;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            font-family: 'Press Start 2P', cursive;
        }
        .task-progress, .reward-progress {
            width: 100%;
            height: 0.5rem;
            background-color: #4a4a5a;
            border-radius: 0.25rem;
            margin-top: 0.25rem;
            overflow: hidden;
        }
        .task-progress-bar, .reward-progress-bar {
            height: 100%;
            border-radius: 0.25rem;
            background: linear-gradient(90deg, #00ffff, #00ff00);
            transition: width 0.3s ease-in-out;
        }
        .claim-button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 0.5rem;
            border-radius: 0.25rem;
            cursor: pointer;
            font-family: 'Press Start 2P', cursive;
            font-size: 0.7rem;
        }
        .claim-button:disabled {
            background-color: #4a4a5a;
            cursor: not-allowed;
        }
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
            100% { transform: translateY(0px); }
        }
        .particles {
            position: fixed;
            pointer-events: none;
            font-size: 1.25rem;
            color: #ffd700;
        }
        .settings-icon {
            position: fixed;
            top: 1rem;
            right: 1rem;
            font-size: 1.5rem;
            cursor: pointer;
            z-index: 1002;
        }
        #settingsModal {
            background-color: rgba(0, 0, 0, 0.9);
        }
        .color-option {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 0.25rem;
            transition: background-color 0.2s;
        }
        .color-option:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        .color-preview {
            width: 30px;
            height: 30px;
            margin-right: 1rem;
            border: 2px solid white;
            border-radius: 50%;
        }
        .settings-section {
            margin-bottom: 1.5rem;
        }
        .settings-section h3 {
            color: #ffd700;
            margin-bottom: 0.5rem;
        }
        #userCode {
            background-color: rgba(255, 255, 255, 0.1);
            padding: 0.5rem;
            border-radius: 0.25rem;
            font-size: 1rem;
            text-align: center;
        }
    </style>
</head>
<body>
    <div id="settingsIcon" class="settings-icon" onclick="openModal('settings')">‚öôÔ∏è</div>
    <div class="container">
        <h1>–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ –ö–æ—Ä–≥–∏ –ö–ª–∏–∫–µ—Ä</h1>
        <div class="game-container">
            <div class="orbit-container">
                <div id="clickArea"></div>
            </div>
            <div class="stats">
                <div id="score">–õ–∞–∫–æ–º—Å—Ç–≤–∞: 0</div>
                <div id="cps">–í —Å–µ–∫—É–Ω–¥—É: 0</div>
            </div>
            <div class="button-container">
                <button class="game-button" onclick="openModal('shop')">üè™ –ú–∞–≥–∞–∑–∏–Ω</button>
                <button class="game-button" onclick="openModal('rewards')">üèÜ –ù–∞–≥—Ä–∞–¥—ã</button>
                <button class="game-button" onclick="openModal('tasks')">üìã –ó–∞–¥–∞–Ω–∏—è</button>
                <button class="game-button" onclick="openModal('settings')">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <div id="shopModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">üè™ –ú–∞–≥–∞–∑–∏–Ω –ö–æ—Ä–≥–∏</h2>
                <button class="close-button" onclick="closeModal('shop')">&times;</button>
            </div>
            <div id="shopItems"></div>
        </div>
    </div>

    <div id="rewardsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">üèÜ –ù–∞–≥—Ä–∞–¥—ã</h2>
                <button class="close-button" onclick="closeModal('rewards')">&times;</button>
            </div>
            <div id="rewardsList"></div>
        </div>
    </div>

    <div id="tasksModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">üìã –ó–∞–¥–∞–Ω–∏—è</h2>
                <button class="close-button" onclick="closeModal('tasks')">&times;</button>
            </div>
            <div id="tasksList"></div>
        </div>
    </div>

    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
                <button class="close-button" onclick="closeModal('settings')">&times;</button>
            </div>
            <div class="settings-section">
                <h3>–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ–Ω:</h3>
                <div id="backgroundOptions"></div>
            </div>
            <div class="settings-section">
                <h3>–í–∞—à –∫–æ–¥:</h3>
                <div id="userCode"></div>
            </div>
        </div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        let cookies = 0;
        let cps = 0;
        let clickPower = 1;
        let totalClicks = 0;
        let items = [
            { name: 'paw', cost: 10, clickPower: 1, owned: 0, description: "–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å–∏–ª—É –∫–ª–∏–∫–∞ –Ω–∞ 1" },
            { name: 'puppy', cost: 15, cps: 0.1, owned: 0, description: "–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç 0.1 –ª–∞–∫–æ–º—Å—Ç–≤ –≤ —Å–µ–∫—É–Ω–¥—É" },
            { name: 'bowl', cost: 100, cps: 1, owned: 0, description: "–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç 1 –ª–∞–∫–æ–º—Å—Ç–≤–æ –≤ —Å–µ–∫—É–Ω–¥—É" },
            { name: 'toy', cost: 500, cps: 5, owned: 0, description: "–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç 5 –ª–∞–∫–æ–º—Å—Ç–≤ –≤ —Å–µ–∫—É–Ω–¥—É" },
            { name: 'bed', cost: 1000, cps: 10, owned: 0, description: "–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç 10 –ª–∞–∫–æ–º—Å—Ç–≤ –≤ —Å–µ–∫—É–Ω–¥—É" },
            { name: 'house', cost: 5000, cps: 50, owned: 0, description: "–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç 50 –ª–∞–∫–æ–º—Å—Ç–≤ –≤ —Å–µ–∫—É–Ω–¥—É" },
            { name: 'park', cost: 20000, cps: 200, owned: 0, description: "–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç 200 –ª–∞–∫–æ–º—Å—Ç–≤ –≤ —Å–µ–∫—É–Ω–¥—É" }
        ];
        let tasks = [
            { id: 'click_10', name: '–ë—ã—Å—Ç—Ä—ã–µ –∫–ª–∏–∫–∏', description: '–ö–ª–∏–∫–Ω–∏—Ç–µ 10 —Ä–∞–∑', requirement: 10, progress: 0, reward: 50, claimed: false },
            { id: 'buy_puppy', name: '–ö—É–ø–∏—Ç—å —â–µ–Ω–∫–∞', description: '–ö—É–ø–∏—Ç–µ —â–µ–Ω–∫–∞ –ö–æ—Ä–≥–∏', requirement: 1, progress: 0, reward: 100, claimed: false },
            { id: 'reach_cps_1', name: '–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è', description: '–î–æ—Å—Ç–∏–≥–Ω–∏—Ç–µ 1 –ª–∞–∫–æ–º—Å—Ç–≤–∞ –≤ —Å–µ–∫—É–Ω–¥—É', requirement: 1, progress: 0, reward: 200, claimed: false }
        ];
        let rewards = [
            { id: 'first_click', name: '–ü–µ—Ä–≤—ã–π –∫–ª–∏–∫', description: '–°–¥–µ–ª–∞–π—Ç–µ –ø–µ—Ä–≤—ã–π –∫–ª–∏–∫', requirement: 1, claimed: false },
            { id: 'click_100', name: '100 –∫–ª–∏–∫–æ–≤', description: '–°–¥–µ–ª–∞–π—Ç–µ 100 –∫–ª–∏–∫–æ–≤', requirement: 100, claimed: false },
            { id: 'click_1000', name: '1000 –∫–ª–∏–∫–æ–≤', description: '–°–¥–µ–ª–∞–π—Ç–µ 1000 –∫–ª–∏–∫–æ–≤', requirement: 1000, claimed: false },
            { id: 'treats_1000', name: '1000 –ª–∞–∫–æ–º—Å—Ç–≤', description: '–ù–∞–∫–æ–ø–∏—Ç–µ 1000 –ª–∞–∫–æ–º—Å—Ç–≤', requirement: 1000, claimed: false },
            { id: 'cps_10', name: '10 –≤ —Å–µ–∫—É–Ω–¥—É', description: '–î–æ—Å—Ç–∏–≥–Ω–∏—Ç–µ 10 –ª–∞–∫–æ–º—Å—Ç–≤ –≤ —Å–µ–∫—É–Ω–¥—É', requirement: 10, claimed: false }
        ];
        let userCode = generateUserCode();
        let backgroundColors = [
            { name: '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π', value: 'linear-gradient(to bottom, #1a1c2c, #2b2e4a)' },
            { name: '–ó–∞–∫–∞—Ç', value: 'linear-gradient(to bottom, #ff7e5f, #feb47b)' },
            { name: '–û–∫–µ–∞–Ω', value: 'linear-gradient(to bottom, #2c3e50, #4ca1af)' },
            { name: '–õ–µ—Å', value: 'linear-gradient(to bottom, #134e5e, #71b280)' },
            { name: '–ù–æ—á—å', value: 'linear-gradient(to bottom, #0f2027, #203a43, #2c5364)' }
        ];

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
        const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
        const storageKey = isMobile ? 'corgiClickerMobileSave' : 'corgiClickerDesktopSave';

        function loadGame() {
            const savedGame = localStorage.getItem(storageKey);
            if (savedGame) {
                const gameState = JSON.parse(savedGame);
                cookies = gameState.cookies;
                cps = gameState.cps;
                clickPower = gameState.clickPower;
                totalClicks = gameState.totalClicks;
                items = gameState.items;
                tasks = gameState.tasks;
                rewards = gameState.rewards;
                userCode = gameState.userCode || generateUserCode();
                if (gameState.backgroundIndex !== undefined) {
                    changeBackground(gameState.backgroundIndex);
                }
                updateDisplay();
            }
        }

        function saveGame() {
            const gameState = {
                cookies,
                cps,
                clickPower,
                totalClicks,
                items,
                tasks,
                rewards,
                userCode,
                backgroundIndex: backgroundColors.findIndex(color => color.value === document.body.style.background)
            };
            localStorage.setItem(storageKey, JSON.stringify(gameState));
        }

        function clickCookie(event) {
            event.preventDefault();
            cookies += clickPower;
            totalClicks++;
            updateDisplay();
            const x = event.changedTouches ? event.changedTouches[0].clientX : event.clientX;
            const y = event.changedTouches ? event.changedTouches[0].clientY : event.clientY;
            createParticle(x, y);
            checkTasks();
            checkRewards();
            saveGame();
        }

        function createParticle(x, y) {
            const particle = document.createElement('div');
            particle.className = 'particles';
            particle.style.left = x + 'px';
            particle.style.top = y + 'px';
            particle.textContent = '+' + clickPower;
            document.body.appendChild(particle);

            particle.animate([
                { transform: 'translateY(0) rotate(0deg)', opacity: 1 },
                { transform: `translateY(-50px) rotate(${(Math.random() - 0.5) * 90}deg)`, opacity: 0 }
            ], {
                duration: 1000,
                easing: 'ease-out'
            }).onfinish = () => particle.remove();
        }

        function updateDisplay() {
            document.getElementById('score').textContent = '–õ–∞–∫–æ–º—Å—Ç–≤–∞: ' + Math.floor(cookies);
            document.getElementById('cps').textContent = '–í —Å–µ–∫—É–Ω–¥—É: ' + cps.toFixed(1);
        }

        function openModal(modalType) {
            document.getElementById(modalType + 'Modal').style.display = 'block';
            document.getElementById('settingsIcon').style.display = 'none';
            if (modalType === 'shop') {
                updateShop();
            } else if (modalType === 'rewards') {
                updateRewards();
            } else if (modalType === 'tasks') {
                updateTasks();
            } else if (modalType === 'settings') {
                updateSettings();
            }
        }

        function closeModal(modalType) {
            document.getElementById(modalType + 'Modal').style.display = 'none';
            document.getElementById('settingsIcon').style.display = 'block';
        }

        function updateShop() {
            const shopItems = document.getElementById('shopItems');
            shopItems.innerHTML = '';
            items.forEach((item, index) => {
                const itemElement = document.createElement('div');
                itemElement.className = 'shop-item';
                itemElement.innerHTML = `
                    <img src="https://api.iconify.design/${item.name === 'paw' ? 'noto:paw-prints' : 
                                    item.name === 'puppy' ? 'noto:dog-face' : 
                                    item.name === 'bowl' ? 'noto:bowl-with-spoon' : 
                                    item.name === 'toy' ? 'emojione:teddy-bear' : 
                                    item.name === 'bed' ? 'emojione:sleeping-face' : 
                                    item.name === 'house' ? 'emojione:house' : 
                                    'noto:park'}.svg" alt="${item.name}">
                    <div class="item-info">
                        <div class="item-name">${getItemName(item.name)}</div>
                        <div class="item-cost">–¶–µ–Ω–∞: ${item.cost} –ª–∞–∫–æ–º—Å—Ç–≤</div>
                        <div class="item-owned">–£—Ä–æ–≤–µ–Ω—å: ${item.owned}</div>
                    </div>
                    <span class="help-icon" onclick="showTooltip('${item.description}')">?</span>
                `;
                itemElement.onclick = (e) => {
                    if (!e.target.classList.contains('help-icon')) {
                        purchaseItem(index);
                    }
                };
                shopItems.appendChild(itemElement);
            });
        }

        function getItemName(itemName) {
            switch(itemName) {
                case 'paw': return '–í–æ–ª—à–µ–±–Ω–∞—è –õ–∞–ø–∞';
                case 'puppy': return '–©–µ–Ω–æ–∫ –ö–æ—Ä–≥–∏';
                case 'bowl': return '–ú–∏—Å–∫–∞';
                case 'toy': return '–ü–∏—â–∞—â–∞—è –∏–≥—Ä—É—à–∫–∞';
                case 'bed': return '–õ–µ–∂–∞–Ω–∫–∞ –ö–æ—Ä–≥–∏';
                case 'house': return '–î–æ–º–∏–∫ –ö–æ—Ä–≥–∏';
                case 'park': return '–ü–∞—Ä–∫ –¥–ª—è –ö–æ—Ä–≥–∏';
                default: return itemName;
            }
        }

        function showTooltip(text) {
            const tooltip = document.getElementById('tooltip');
            tooltip.textContent = text;
            tooltip.style.display = 'block';
            setTimeout(() => {
                tooltip.style.display = 'none';
            }, 2000);
        }

        function purchaseItem(index) {
            const item = items[index];
            if (cookies >= item.cost) {
                cookies -= item.cost;
                item.owned++;
                if (item.clickPower) {
                    clickPower += item.clickPower;
                }
                if (item.cps) {
                    cps += item.cps;
                }
                item.cost = Math.ceil(item.cost * 1.15);
                updateDisplay();
                updateShop();
                checkTasks();
                saveGame();
            }
        }

        function updateRewards() {
            const rewardsList = document.getElementById('rewardsList');
            rewardsList.innerHTML = '';
            rewards.forEach(reward => {
                const rewardElement = document.createElement('div');
                rewardElement.className = 'reward-item';
                const progress = reward.id === 'treats_1000' ? Math.min(cookies / reward.requirement, 1) :
                                 reward.id === 'cps_10' ? Math.min(cps / reward.requirement, 1) :
                                 Math.min(totalClicks / reward.requirement, 1);
                rewardElement.innerHTML = `
                    <div class="reward-info">
                        <h3>${reward.name}</h3>
                        <p>${reward.description}</p>
                        <div class="reward-progress">
                            <div class="reward-progress-bar" style="width: ${progress * 100}%"></div>
                        </div>
                    </div>
                    ${!reward.claimed ? `<button class="claim-button" onclick="claimReward('${reward.id}')" ${progress < 1 ? 'disabled' : ''}>–ó–∞–±—Ä–∞—Ç—å</button>` : '<p class="claimed">–ü–æ–ª—É—á–µ–Ω–æ</p>'}
                `;
                rewardsList.appendChild(rewardElement);
            });
        }

        function claimReward(rewardId) {
            const reward = rewards.find(r => r.id === rewardId);
            if (reward && !reward.claimed) {
                const progress = reward.id === 'treats_1000' ? cookies / reward.requirement :
                                 reward.id === 'cps_10' ? cps / reward.requirement :
                                 totalClicks / reward.requirement;
                if (progress >= 1) {
                    reward.claimed = true;
                    cookies += 1000;
                    updateDisplay();
                    updateRewards();
                    saveGame();
                }
            }
        }

        function updateTasks() {
            const tasksList = document.getElementById('tasksList');
            tasksList.innerHTML = '';
            tasks.forEach(task => {
                const taskElement = document.createElement('div');
                taskElement.className = 'task-item';
                const progress = task.progress / task.requirement;
                taskElement.innerHTML = `
                    <div class="task-info">
                        <h3>${task.name}</h3>
                        <p>${task.description}</p>
                        <div class="task-progress">
                            <div class="task-progress-bar" style="width: ${progress * 100}%"></div>
                        </div>
                        <div class="task-progress-text">${task.progress}/${task.requirement}</div>
                    </div>
                    <div class="task-reward">–ù–∞–≥—Ä–∞–¥–∞: ${task.reward} –ª–∞–∫–æ–º—Å—Ç–≤</div>
                    ${!task.claimed && task.progress >= task.requirement ? `<button class="claim-button" onclick="claimTask('${task.id}')">–ü–æ–ª—É—á–∏—Ç—å –Ω–∞–≥—Ä–∞–¥—É</button>` : ''}
                    ${task.claimed ? '<p class="claimed">–ù–∞–≥—Ä–∞–¥–∞ –ø–æ–ª—É—á–µ–Ω–∞</p>' : ''}
                `;
                tasksList.appendChild(taskElement);
            });
        }

        function claimTask(taskId) {
            const task = tasks.find(t => t.id === taskId);
            if (task && !task.claimed && task.progress >= task.requirement) {
                task.claimed = true;
                cookies += task.reward;
                updateDisplay();
                updateTasks();
                saveGame();
            }
        }

        function checkTasks() {
            tasks.forEach(task => {
                switch (task.id) {
                    case 'click_10':
                        task.progress = Math.min(totalClicks, task.requirement);
                        break;
                    case 'buy_puppy':
                        task.progress = items[1].owned > 0 ? 1 : 0;
                        break;
                    case 'reach_cps_1':
                        task.progress = cps >= 1 ? 1 : 0;
                        break;
                }
            });
            updateTasks();
        }

        function checkRewards() {
            rewards.forEach(reward => {
                switch (reward.id) {
                    case 'first_click':
                        if (totalClicks >= 1 && !reward.claimed) {
                            reward.claimed = true;
                        }
                        break;
                    case 'click_100':
                        if (totalClicks >= 100 && !reward.claimed) {
                            reward.claimed = true;
                        }
                        break;
                    case 'click_1000':
                        if (totalClicks >= 1000 && !reward.claimed) {
                            reward.claimed = true;
                        }
                        break;
                    case 'treats_1000':
                        if (cookies >= 1000 && !reward.claimed) {
                            reward.claimed = true;
                        }
                        break;
                    case 'cps_10':
                        if (cps >= 10 && !reward.claimed) {
                            reward.claimed = true;
                        }
                        break;
                }
            });
            updateRewards();
        }

        function generateUserCode() {
            return Math.random().toString(36).substr(2, 8).toUpperCase();
        }

        function updateSettings() {
            const backgroundOptions = document.getElementById('backgroundOptions');
            backgroundOptions.innerHTML = '';
            backgroundColors.forEach((color, index) => {
                const option = document.createElement('div');
                option.className = 'color-option';
                option.innerHTML = `
                    <div class="color-preview" style="background: ${color.value};"></div>
                    <span>${color.name}</span>
                `;
                option.onclick = () => changeBackground(index);
                backgroundOptions.appendChild(option);
            });

            const userCodeElement = document.getElementById('userCode');
            userCodeElement.textContent = userCode;
        }

        function changeBackground(index) {
            document.body.style.background = backgroundColors[index].value;
            saveGame();
        }

        document.addEventListener('DOMContentLoaded', () => {
            loadGame();
            const clickArea = document.getElementById('clickArea');
            clickArea.addEventListener('click', clickCookie);
            clickArea.addEventListener('touchend', clickCookie);
            setInterval(() => {
                cookies += cps;
                updateDisplay();
                saveGame();
            }, 1000);
        });
    </script>
</body>
</html>
